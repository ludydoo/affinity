Ext.data.JsonP.updatable_views_proposal({"guide":"<h1 id='updatable_views_proposal-section-proposal-for-updatable-views'>Proposal for Updatable Views</h1>\n<div class='toc'>\n<p><strong>Contents</strong></p>\n<ol>\n<li><a href='#!/guide/updatable_views_proposal-section-the-problem'>The Problem</a></li>\n<li><a href='#!/guide/updatable_views_proposal-section-difference'>Difference</a></li>\n<li><a href='#!/guide/updatable_views_proposal-section-extension'>Extension</a></li>\n</ol>\n</div>\n\n<h2 id='updatable_views_proposal-section-the-problem'>The Problem</h2>\n\n<p>DBMS also have a problem with this. There are a lot of restrictions in order to be able to update views. Since\nrelational operators are basically views of relations, being able to update them would be of great help because\nwe rarely deal directly with raw data, but with filtered, formatted data.</p>\n\n<p>To be able to update a view (meaning be able to perform add, delete and update operations), we must be able\nto \"revert\" the relational operators. For certain operators (such as Rename or Restrict) this is easy because\nthere is only one possible solution to revert the operation. Though, for operators that take in two relations,\nthere is an ambiguity on the possible solution to the update problem that arises.</p>\n\n<p>For example, the following operation :</p>\n\n<pre><code>var people = new affinity.Relation(...)\n\n+---------------------+------------------------+-------------------+\n| personName : String | personSalary : Integer | deptName : String |\n+=====================+========================+===================+\n| Henry               | 200                    | Sales             |\n+---------------------+------------------------+-------------------+\n| Paul                | 300                    | Sales             |\n+---------------------+------------------------+-------------------+\n| Natasha             | 400                    | Service           |\n+---------------------+------------------------+-------------------+\n| Mary                | 350                    | Service           |\n+---------------------+------------------------+-------------------+\n| Snazzy              | 250                    | R&amp;D               |\n+---------------------+------------------------+-------------------+\n| Dumple              | 210                    | R&amp;D               |\n+---------------------+------------------------+-------------------+\n\nvar depts = new affinity.Relation(...)\n\n+-------------------+---------------------+\n| deptName : String | deptLevel : Integer |\n+===================+=====================+\n| Sales             | 1                   |\n+-------------------+---------------------+\n| Service           | 2                   |\n+-------------------+---------------------+\n| R&amp;D               | 2                   |\n+-------------------+---------------------+\n\nvar peopleDept = people.join(depts);\n\n+---------------------+------------------------+-------------------+---------------------+\n| personName : String | personSalary : Integer | deptName : String | deptLevel : Integer |\n+=====================+========================+===================+=====================+\n| Henry               | 200                    | Sales             | 1                   |\n+---------------------+------------------------+-------------------+---------------------+\n| Paul                | 300                    | Sales             | 1                   |\n+---------------------+------------------------+-------------------+---------------------+\n| Natasha             | 400                    | Service           | 2                   |\n+---------------------+------------------------+-------------------+---------------------+\n| Mary                | 350                    | Service           | 2                   |\n+---------------------+------------------------+-------------------+---------------------+\n| Snazzy              | 250                    | R&amp;D               | 2                   |\n+---------------------+------------------------+-------------------+---------------------+\n| Dumple              | 210                    | R&amp;D               | 2                   |\n+---------------------+------------------------+-------------------+---------------------+\n</code></pre>\n\n<p>Let's say we wanted to add this tuple to the <code>peopleDept</code> relation :</p>\n\n<pre><code>+---------------------+------------------------+-------------------+---------------------+\n| Kimble              | 300                    | R&amp;D               | 2                   |\n+---------------------+------------------------+-------------------+---------------------+\n</code></pre>\n\n<p>To make this view updatable, meaning that it will revert its changes back into the base relations\nwe would simply have to add</p>\n\n<pre><code>+---------------------+------------------------+-------------------+\n| Kimble              | 300                    | R&amp;D               |\n+---------------------+------------------------+-------------------+\n</code></pre>\n\n<p>To the <code>people</code> relation. It's easy. But it gets a little complicated. Let's say we\nwanted to add :</p>\n\n<pre><code>+---------------------+------------------------+-------------------+---------------------+\n| Kimble              | 300                    | Comm              | 3                   |\n+---------------------+------------------------+-------------------+---------------------+\n</code></pre>\n\n<p>to the <code>peopleDepts</code> relation. Then, we would have to add</p>\n\n<pre><code>+---------------------+------------------------+-------------------+\n| Kimble              | 300                    | Comm              |\n+---------------------+------------------------+-------------------+\n</code></pre>\n\n<p>To the <code>people</code> relation and also</p>\n\n<pre><code> +-------------------+---------------------+\n | Comm              | 3                   |\n +-------------------+---------------------+\n</code></pre>\n\n<p>To the <code>depts</code> relation.</p>\n\n<p>This is not the most complicated example. But many update operations can be reverted by many ways,\nmeaning that there will be multiple ways of reverting the operation that would yield the same final result.</p>\n\n<h2 id='updatable_views_proposal-section-difference'>Difference</h2>\n\n<pre><code>var people = new affinity.Relation(...)\nvar employees = new affinity.Relation(...);\nvar clients = people.difference(employees);\n\n  People                  Employees               Clients\n+---------------------+ +---------------------+ +---------------------+\n| personName : String | | personName : String | | personName : String |\n+=====================+ +=====================+ +=====================+\n| Henry               | | Henry               | | Mary                |\n+---------------------+ +---------------------+ +---------------------+\n| Paul                | | Paul                | | Snazzy              |\n+---------------------+ +---------------------+ +---------------------+\n| Natasha             | | Natasha             | | Dumple              |\n+---------------------+ +---------------------+ +---------------------+\n| Mary                |\n+---------------------+\n| Snazzy              |\n+---------------------+\n| Dumple              |\n+---------------------+\n</code></pre>\n\n<h3 id='updatable_views_proposal-section-add'>Add</h3>\n\n<p>General strategy:</p>\n\n<ul>\n<li>When present in right but not in left : remove it from right</li>\n<li>When not present in left : add it to left</li>\n</ul>\n\n\n<p>Ambiguities: None</p>\n\n<h4 id='updatable_views_proposal-section-add-when-not-present-in-left-nor-in-right-relation'>Add when not present in left nor in right relation</h4>\n\n<p>Can be added to left relation</p>\n\n<pre><code>clients.add({personName : \"Gibble\"});\n\n People                  Employees               Clients = people.difference(employees)\n+---------------------+ +---------------------+ +---------------------+\n| personName : String | | personName : String | | personName : String |\n+=====================+ +=====================+ +=====================+\n| Henry               | | Henry               | | Mary                |\n+---------------------+ +---------------------+ +---------------------+\n| Paul                | | Paul                | | Snazzy              |\n+---------------------+ +---------------------+ +---------------------+\n| Natasha             | | Natasha             | | Dumple              |\n+---------------------+ +---------------------+ +---------------------+\n| Mary                |                         +---------------------+\n+---------------------+                         | Gibble              | +\n| Snazzy              |                         +---------------------+\n+---------------------+\n| Dumple              |\n+---------------------+\n+---------------------+\n| Gibble              | +\n+---------------------+\n</code></pre>\n\n<h4 id='updatable_views_proposal-section-add-when-present-in-right-relation-and-in-left-relation'>Add when present in right relation and in left relation</h4>\n\n<p>Can be removed from right relation</p>\n\n<pre><code>clients.add({personName : \"Henry\"});\n\n People                  Employees                 Clients = people.difference(employees)\n+---------------------+ +---------------------+   +---------------------+\n| personName : String | | personName : String |   | personName : String |\n+=====================+ +=====================+   +=====================+\n| Henry               | | Paul                |   | Mary                |\n+---------------------+ +---------------------+   +---------------------+\n| Paul                | | Natasha             |   | Snazzy              |\n+---------------------+ +---------------------+   +---------------------+\n| Natasha             | +---------------------+   | Dumple              |\n+---------------------+ | Henry               | - +---------------------+\n| Mary                | +---------------------+   +---------------------+\n+---------------------+                           | Henry               | +\n| Snazzy              |                           +---------------------+\n+---------------------+\n| Dumple              |\n+---------------------+\n</code></pre>\n\n<h4 id='updatable_views_proposal-section-add-when-present-in-right-relation-but-not-in-left-relation'>Add when present in right relation but not in left relation</h4>\n\n<p>Can be added to left and removed from right</p>\n\n<pre><code>clients.add({personName : \"Gibble\"});\n\n  People                    Employees                 Clients                                                                                                   \n+---------------------+   +---------------------+   +---------------------+\n| personName : String |   | personName : String |   | personName : String |\n+=====================+   +=====================+   +=====================+\n| Henry               |   | Henry               |   | Mary                |\n+---------------------+   +---------------------+   +---------------------+\n| Paul                |   | Paul                |   | Snazzy              |\n+---------------------+   +---------------------+   +---------------------+\n| Natasha             |   | Natasha             |   | Dumple              |\n+---------------------+   +---------------------+   +---------------------+\n| Mary                |   +---------------------+   +---------------------+\n+---------------------+   | Greg                | - | Greg                | +\n| Snazzy              |   +---------------------+   +---------------------+\n+---------------------+\n| Dumple              |\n+---------------------+\n+---------------------+\n| Greg                | +\n+---------------------+\n</code></pre>\n\n<h3 id='updatable_views_proposal-section-delete'>Delete</h3>\n\n<p>General Strategy:</p>\n\n<ul>\n<li>Can be removed from left</li>\n<li>Can be added to right</li>\n<li>Both</li>\n</ul>\n\n\n<p>Ambiguities : 3</p>\n\n<h4 id='updatable_views_proposal-section-when-present-in-left-but-not-in-right-%28only-case%29'>When present in left but not in right (Only case)</h4>\n\n<p>Can be removed from left relation</p>\n\n<pre><code>  People                    Employees               Clients\n+---------------------+   +---------------------+ +---------------------+\n| personName : String |   | personName : String | | personName : String |\n+=====================+   +=====================+ +=====================+\n| Henry               |   | Henry               | | Mary                |\n+---------------------+   +---------------------+ +---------------------+\n| Paul                |   | Paul                | | Snazzy              |\n+---------------------+   +---------------------+ +---------------------+\n| Natasha             |   | Natasha             | +---------------------+\n+---------------------+   +---------------------+ | Dumple              | -\n| Mary                |                           +---------------------+\n+---------------------+\n| Snazzy              |\n+---------------------+\n+---------------------+\n| Dumple              | -\n+---------------------+\n</code></pre>\n\n<p>Can be added to right relation</p>\n\n<pre><code>  People                  Employees                 Clients\n+---------------------+ +---------------------+   +---------------------+\n| personName : String | | personName : String |   | personName : String |\n+=====================+ +=====================+   +=====================+\n| Henry               | | Henry               |   | Mary                |\n+---------------------+ +---------------------+   +---------------------+\n| Paul                | | Paul                |   | Snazzy              |\n+---------------------+ +---------------------+   +---------------------+\n| Natasha             | | Natasha             |   +---------------------+\n+---------------------+ +---------------------+   | Dumple              | -\n| Mary                | +---------------------+   +---------------------+\n+---------------------+ | Dumple              | +\n| Snazzy              | +---------------------+\n+---------------------+\n| Dumple              |\n+---------------------+\n</code></pre>\n\n<p>Can be removed from left and added to right</p>\n\n<pre><code>  People                    Employees                 Clients                                 \n+---------------------+   +---------------------+   +---------------------+                                 \n| personName : String |   | personName : String |   | personName : String |                                 \n+=====================+   +=====================+   +=====================+                                 \n| Henry               |   | Henry               |   | Mary                |                                 \n+---------------------+   +---------------------+   +---------------------+                                 \n| Paul                |   | Paul                |   | Snazzy              |                                 \n+---------------------+   +---------------------+   +---------------------+                                 \n| Natasha             |   | Natasha             |   +---------------------+                                 \n+---------------------+   +---------------------+   | Dumple              | -                                  \n| Mary                |   +---------------------+   +---------------------+                                                         \n+---------------------+   | Dumple              | +                                          \n| Snazzy              |   +---------------------+                                                      \n+---------------------+\n+---------------------+\n| Dumple              | -                              \n+---------------------+\n</code></pre>\n\n<h3 id='updatable_views_proposal-section-update'>Update</h3>\n\n<p>General Strategy:</p>\n\n<ul>\n<li>Update the left relation</li>\n</ul>\n\n\n<p>Ambiguities : Duplicate handling</p>\n\n<h4 id='updatable_views_proposal-section-update-left-relation'>Update left relation</h4>\n\n<pre><code>  People                  Employees               Clients\n+---------------------+ +---------------------+ +---------------------+\n| personName : String | | personName : String | | personName : String |\n+=====================+ +=====================+ +=====================+\n| Henry               | | Henry               | | Mary                |\n+---------------------+ +---------------------+ +---------------------+\n| Paul                | | Paul                | | Snazzy              |\n+---------------------+ +---------------------+ +---------------------+\n| Natasha             | | Natasha             | | Dumple              | -&gt; Baffle\n+---------------------+ +---------------------+ +---------------------+\n| Mary                |\n+---------------------+\n| Snazzy              |\n+---------------------+\n| Dumple              | -&gt; Baffle\n+---------------------+\n</code></pre>\n\n<h4 id='updatable_views_proposal-section-duplicates'>Duplicates</h4>\n\n<pre><code> People                  Employees               Clients\n+---------------------+ +---------------------+ +---------------------+\n| personName : String | | personName : String | | personName : String |\n+=====================+ +=====================+ +=====================+\n| Henry               | | Henry               | | Mary                |\n+---------------------+ +---------------------+ +---------------------+\n| Paul                | | Paul                | | Snazzy              |\n+---------------------+ +---------------------+ +---------------------+\n| Natasha             | | Natasha             | | Dumple              | -&gt; Henry\n+---------------------+ +---------------------+ +---------------------+\n| Mary                |\n+---------------------+\n| Snazzy              |\n+---------------------+\n| Dumple              | -&gt; Henry\n+---------------------+\n</code></pre>\n\n<p>Possible solutions :</p>\n\n<ul>\n<li>Error</li>\n<li>Silently Ignore</li>\n</ul>\n\n\n<h2 id='updatable_views_proposal-section-extension'>Extension</h2>\n\n<h3 id='updatable_views_proposal-section-add'>Add</h3>\n\n<p>Only allow adding of non-calculated attributes</p>\n\n<pre><code> var relation = new affinity.Relation(...)\n\n var extended = relation.extend([{ tilBirthday : born.weekOfYear() }])\n\n // relation                           // extended  \n +---------------+-------------+       +---------------+-------------++----------------+  \n | name : String | born : Date |       | name : String | born : Date || week : Integer |  \n +===============+=============+       +===============+=============++================+  \n | John Doe      | 1980-02-02  |       | John Doe      | 1980-02-02  || 0              |  \n +---------------+-------------+       +---------------+-------------++----------------+  \n | Marilyn       | 1962-01-30  |       | Marilyn       | 1962-01-30  || 4              |  \n +---------------+-------------+       +---------------+-------------++----------------+  \n +---------------+-------------+       +---------------+-------------+  \n | Dalia         | 1957-08-10  | + &lt;-  | Dalia         | 1957-08-10  | +  \n +---------------+-------------+       +---------------+-------------+  \n</code></pre>\n\n<h3 id='updatable_views_proposal-section-delete'>Delete</h3>\n\n<p>Delete the tuple from the original relation</p>\n\n<h3 id='updatable_views_proposal-section-update'>Update</h3>\n\n<p>Only allow update of non-calculated fields</p>\n\n<pre><code> // relation                           // extended                                           \n +---------------+-------------+       +---------------+-------------++----------------+     \n | name : String | born : Date |       | name : String | born : Date || week : Integer |     \n +===============+=============+       +===============+=============++================+     \n | John Doe      | 1980-02-02  |       | John Doe      | 1980-02-02  || 0              |     \n +---------------+-------------+       +---------------+-------------++----------------+     \n\n tuple.set('name', \"Mary Poppins\")\n tuple.set('born', new Date(1820, 10, 10));\n\n // The calculated fields should calculate themselves.\n</code></pre>\n","title":"Proposal for Updatable Views"});